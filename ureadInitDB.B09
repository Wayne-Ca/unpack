PROCEDURE ureadInitDB (* Variable Array Record *) TYPE VREC=vTyp,nTyp:BYTE; nVar:BOOLEAN; vOff,vdOff,dsOff,dmOff,fOff,pOff:INTEGER DIM varRec:VREC (* File Record *) TYPE VFP1=vdTkn:BYTE; vdPtr,vdSiz,dsPtr,dsvSiz,dsSiz,dmSiz,fSiz,pSiz,elem1,elem2,elem3,vSRLen:INTEGER TYPE VFP2=vArray:STRING[19]; vName:STRING[29]; vStrLen:STRING[7]; vRecNum,vRefCnt,intReal,pVar:INTEGER TYPE VFP3=mTyp,vLnk,fNum:BYTE; pRec,pFld:BOOLEAN TYPE VFRC= vp1:VFP1; vp2:VFP2; vp3:VFP3 DIM varFRec:VFRC (* DSMap - DSAT Map *) TYPE DSMP=dsOf,dsDm,dsMSz,dsSz:INTEGER DIM DSMap(100):DSMP DIM cls,outPath:BYTE DIM cntr,col,row,recNum,tmpTkn:INTEGER DIM outOpen:BOOLEAN DIM key:STRING[1]; tmpCmd:STRING[6]; version:STRING[8]; dataDir:STRING[16]; outFile:STRING[29]  BASE 0 cls:=12 recNum:=0  PUT #1,cls dataDir:="/DD/DATA/UNPACK/" outFile:=dataDir+"initDB" PRINT "Reading initDB";  OPEN #outPath,outFile:READ outOpen:=TRUE GET #outPath,version GET #outPath,varFRec GET #outPath,DSMap CLOSE #outPath outOpen:=FALSE FOR cntr:=1 TO 20000 \NEXT cntr PRINT   10 PUT #1,cls PRINT "Current version: "; version PRINT "variable size: "; SIZE(version) PRINT  \ PRINT PRINT "1) Default Variable Records" PRINT "2) Default Description Area Map"  key:="" REPEAT RUN Inkey(key) UNTIL key<>"" AND SUBSTR(key,"12")>0 PRINT IF VAL(key)>0 THEN ON VAL(key) GOSUB 60,70,80 FOR cntr:=1 TO 20000 \NEXT cntr GOTO 10 ENDIF END  (* Variable Data *) 60 PUT #1,cls GOSUB 200 col:=14 \row:=0 \ GOSUB 110 PRINT USING "i4<",recNum+1; col:=31 \row:=0 \ GOSUB 110 PRINT varFRec.vp2.vName; " "; col:=58 \row:=0 \ GOSUB 110 PRINT USING "i2<",varFRec.vp3.fNum;  col:=14 \row:=1 \ GOSUB 110 PRINT USING "h4",varRec.vOff; col:=31 \row:=1 \ GOSUB 110 PRINT USING "h2",varRec.vTyp; IF varRec.vTyp>=$80 AND varRec.vTyp<=$83 THEN   IF varRec.vTyp=$80 THEN     PRINT " BYTE";   ELSE     IF varRec.vTyp=$81 THEN       PRINT " INTEGER";     ELSE       IF varRec.vTyp=$82 THEN         PRINT " REAL";       ELSE         IF varRec.vTyp=$83 THEN           PRINT " BOOLEAN";         ENDIF       ENDIF     ENDIF   ENDIF   PRINT " (Data Memory)   "; ELSE   IF varRec.vTyp>=$00 AND varRec.vTyp<=$03 THEN     IF varRec.vTyp=$00 OR  varRec.vTyp=$01 THEN       PRINT " INTEGER";     ELSE       IF varRec.vTyp=$02 OR  varRec.vTyp=$03 THEN         PRINT " REAL";       ENDIF     ENDIF     PRINT " (Data Memory)   ";   ELSE     IF varRec.vTyp=$46 OR varRec.vTyp=$47 THEN       IF varFRec.vp2.intReal=1 THEN         PRINT " INTEGER";       ELSE         IF varFRec.vp2.intReal=2 THEN           PRINT " REAL";         ENDIF       ENDIF       PRINT " (Data Memory)   ";     ELSE       IF varRec.vTyp=$84 THEN         PRINT " (DSAT)               ";       ELSE         PRINT " (VDT)                ";       ENDIF     ENDIF   ENDIF ENDIF  col:=14 \row:=4 \ GOSUB 110 PRINT USING "h4",varRec.dmOff; col:=25 \row:=4 \ GOSUB 110 PRINT USING "h4",varRec.fOff; col:=36 \row:=4 \ GOSUB 110 PRINT USING "h4",varRec.pOff;  col:=14 \row:=5 \ GOSUB 110 PRINT USING "i5<",varFRec.vp1.dmSiz; col:=25 \row:=5 \ GOSUB 110 PRINT USING "i5<",varFRec.vp1.fSiz; col:=36 \row:=5 \ GOSUB 110 PRINT USING "i5<",varFRec.vp1.pSiz;  col:=14 \row:=8 \ GOSUB 110 PRINT USING "h4",varRec.vdOff; col:=58 \row:=8 \ GOSUB 110 PRINT USING "i5<",varFRec.vp1.vdSiz;  col:=14 \row:=9 \ GOSUB 110 PRINT USING "h2",varFRec.vp1.vdTkn; col:=16 \row:=9 \ GOSUB 110 PRINT "                      "; col:=16 \row:=9 \ GOSUB 110 IF varFRec.vp1.vdTkn>0 THEN   PRINT " (";   IF varFRec.vp1.vdTkn>=$40 AND varFRec.vp1.vdTkn<=$5F THEN     PRINT "Field ";   ENDIF   IF varFRec.vp1.vdTkn>=$80 AND varFRec.vp1.vdTkn<=$9F THEN     PRINT "PARAM ";   ENDIF   IF varFRec.vp1.vdTkn=$40 OR varFRec.vp1.vdTkn=$60 OR varFRec.vp1.vdTkn=$80 THEN     PRINT "BYTE";   ENDIF   IF varFRec.vp1.vdTkn=$48 OR varFRec.vp1.vdTkn=$68 OR varFRec.vp1.vdTkn=$88 THEN     PRINT "BYTE";   ENDIF   IF varFRec.vp1.vdTkn=$50 OR varFRec.vp1.vdTkn=$70 OR varFRec.vp1.vdTkn=$90 THEN     PRINT "BYTE";   ENDIF   IF varFRec.vp1.vdTkn=$58 OR varFRec.vp1.vdTkn=$78 OR varFRec.vp1.vdTkn=$98 THEN     PRINT "BYTE";   ENDIF   IF varFRec.vp1.vdTkn=$41 OR varFRec.vp1.vdTkn=$61 OR varFRec.vp1.vdTkn=$81 THEN     PRINT "INTEGER";   ENDIF   IF varFRec.vp1.vdTkn=$49 OR varFRec.vp1.vdTkn=$69 OR varFRec.vp1.vdTkn=$89 THEN     PRINT "INTEGER";   ENDIF   IF varFRec.vp1.vdTkn=$51 OR varFRec.vp1.vdTkn=$71 OR varFRec.vp1.vdTkn=$91 THEN     PRINT "INTEGER";   ENDIF   IF varFRec.vp1.vdTkn=$59 OR varFRec.vp1.vdTkn=$79 OR varFRec.vp1.vdTkn=$99 THEN     PRINT "INTEGER";   ENDIF   IF varFRec.vp1.vdTkn=$42 OR varFRec.vp1.vdTkn=$62 OR varFRec.vp1.vdTkn=$82 THEN     PRINT "REAL";   ENDIF   IF varFRec.vp1.vdTkn=$4A OR varFRec.vp1.vdTkn=$6A OR varFRec.vp1.vdTkn=$8A THEN     PRINT "REAL";   ENDIF   IF varFRec.vp1.vdTkn=$52 OR varFRec.vp1.vdTkn=$72 OR varFRec.vp1.vdTkn=$92 THEN     PRINT "REAL";   ENDIF   IF varFRec.vp1.vdTkn=$5A OR varFRec.vp1.vdTkn=$7A OR varFRec.vp1.vdTkn=$9A THEN     PRINT "REAL";   ENDIF   IF varFRec.vp1.vdTkn=$43 OR varFRec.vp1.vdTkn=$63 OR varFRec.vp1.vdTkn=$83 THEN     PRINT "BOOLEAN";   ENDIF   IF varFRec.vp1.vdTkn=$4B OR varFRec.vp1.vdTkn=$6B OR varFRec.vp1.vdTkn=$8B THEN     PRINT "BOOLEAN";   ENDIF   IF varFRec.vp1.vdTkn=$53 OR varFRec.vp1.vdTkn=$73 OR varFRec.vp1.vdTkn=$93 THEN     PRINT "BOOLEAN";   ENDIF   IF varFRec.vp1.vdTkn=$5B OR varFRec.vp1.vdTkn=$7B OR varFRec.vp1.vdTkn=$9B THEN     PRINT "BOOLEAN";   ENDIF   IF varFRec.vp1.vdTkn=$44 OR varFRec.vp1.vdTkn=$64 OR varFRec.vp1.vdTkn=$84 THEN     PRINT "STRING";   ENDIF   IF varFRec.vp1.vdTkn=$4C OR varFRec.vp1.vdTkn=$6C OR varFRec.vp1.vdTkn=$8C THEN     PRINT "STRING";   ENDIF   IF varFRec.vp1.vdTkn=$54 OR varFRec.vp1.vdTkn=$74 OR varFRec.vp1.vdTkn=$94 THEN     PRINT "STRING";   ENDIF   IF varFRec.vp1.vdTkn=$5C OR varFRec.vp1.vdTkn=$7C OR varFRec.vp1.vdTkn=$9C THEN     PRINT "STRING";   ENDIF   IF varFRec.vp1.vdTkn=$45 OR varFRec.vp1.vdTkn=$65 OR varFRec.vp1.vdTkn=$85 THEN     PRINT "Record";   ENDIF   IF varFRec.vp1.vdTkn=$4D OR varFRec.vp1.vdTkn=$6D OR varFRec.vp1.vdTkn=$8D THEN     PRINT "Record";   ENDIF   IF varFRec.vp1.vdTkn=$55 OR varFRec.vp1.vdTkn=$75 OR varFRec.vp1.vdTkn=$95 THEN     PRINT "Record";   ENDIF   IF varFRec.vp1.vdTkn=$5D OR varFRec.vp1.vdTkn=$7D OR varFRec.vp1.vdTkn=$9D THEN     PRINT "Record";   ENDIF   IF varFRec.vp1.vdTkn>=$48 AND varFRec.vp1.vdTkn<=$5F OR varFRec.vp1.vdTkn>=$68 AND varFRec.vp1.vdTkn<=$7F OR varFRec.vp1.vdTkn>=$88 AND varFRec.vp1.vdTkn<=$9F THEN     PRINT " Array";   ENDIF   IF varFRec.vp1.vdTkn=$A0 THEN     PRINT "Subroutine";   ENDIF   PRINT ")"; ENDIF col:=58 \row:=9 \ GOSUB 110 PRINT USING "h4",varFRec.vp1.vdPtr; IF varFRec.vp1.vdTkn>=$40 AND varFRec.vp1.vdTkn<=$43 OR varFRec.vp1.vdTkn>=$60 AND varFRec.vp1.vdTkn<=$63 OR varFRec.vp1.vdTkn>=$80 AND varFRec.vp1.vdTkn<=$83 OR varFRec.vp1.vdTkn=$A0 THEN   PRINT " (Data Memory)"; ELSE   IF varFRec.vp1.vdTkn>0 THEN     PRINT " (DSAT)       ";   ELSE     PRINT "              ";   ENDIF ENDIF  col:=14 \row:=12 \ GOSUB 110 IF varRec.vTyp=$84 THEN   PRINT "Instruction Entry: STRING"; ELSE   IF varFRec.vp1.vdTkn>=$44 AND varFRec.vp1.vdTkn<=$5F OR varFRec.vp1.vdTkn>=$64 AND varFRec.vp1.vdTkn<=$7F OR varFRec.vp1.vdTkn>=$84 AND varFRec.vp1.vdTkn<=$9F THEN     PRINT "VDT Entry                ";   ELSE     PRINT "                         ";   ENDIF ENDIF col:=58 \row:=12 \ GOSUB 110 PRINT USING "i6<",varFRec.vp1.dsvSiz;  col:=14 \row:=13 \ GOSUB 110 PRINT USING "h4",varRec.dsOff; col:=31 \row:=13 \ GOSUB 110 PRINT USING "h4",varFRec.vp1.dsPtr; col:=58 \row:=13 \ GOSUB 110 PRINT USING "i6<",varFRec.vp1.vSRLen;  col:=14 \row:=14 \ GOSUB 110 PRINT USING "i6<",varFRec.vp1.elem1; col:=31 \row:=14 \ GOSUB 110 PRINT USING "i6<",varFRec.vp1.elem2; col:=58 \row:=14 \ GOSUB 110 PRINT USING "i6<",varFRec.vp1.elem3;  col:=14 \row:=15 \ GOSUB 110 PRINT USING "i6<",varFRec.vp1.dsSiz; col:=31 \row:=15 \ GOSUB 110 PRINT USING "s19<",varFRec.vp2.vArray; col:=58 \row:=15 \ GOSUB 110 PRINT USING "s7<",varFRec.vp2.vStrLen;  col:=17 \row:=18 \ GOSUB 110 PRINT USING "i2<",varRec.nTyp; col:=34 \row:=18 \ GOSUB 110 PRINT USING "b5",varRec.nVar; col:=52 \row:=18 \ GOSUB 110 PRINT USING "i3<",varFRec.vp2.intReal;  col:=2 \row:=21 \ GOSUB 110 PRINT USING "i4<",varFRec.vp2.vRecNum; col:=12 \row:=21 \ GOSUB 110 PRINT USING "i4<",varFRec.vp2.vRefCnt; col:=25 \row:=21 \ GOSUB 110 PRINT USING "i4<",varFRec.vp2.pVar; col:=38 \row:=21 \ GOSUB 110 PRINT USING "i2<",varFRec.vp3.mTyp;  REPEAT   READ tmpTkn,tmpCmd  UNTIL varFRec.vp3.vLnk=tmpTkn col:=49 \row:=21 \ GOSUB 110 PRINT USING "s6",tmpCmd; col:=58 \row:=21 \ GOSUB 110 PRINT USING "b5",varFRec.vp3.pRec; col:=70 \row:=21 \ GOSUB 110 PRINT USING "b5",varFRec.vp3.pFld; RETURN RETURN   70 FOR cntr:=0 to 99   PRINT DSMap(cntr).dsOf,DSMap(cntr).dsDm,DSMap(cntr).dsMSz,DSMap(cntr).dsSz NEXT cntr RETURN   80 END  110 RUN GFX2("CURXY",col,row) \ RETURN  (* Display *) 200 col:=5 \row:=0 \ GOSUB 110 PRINT "Record#:"; col:=25 \row:=0 \ GOSUB 110 PRINT "Name:"; col:=50 \row:=0 \ GOSUB 110 PRINT "Fields:";  col:=3 \row:=1 \ GOSUB 110 PRINT "Offset to:"; col:=25 \row:=1 \ GOSUB 110 PRINT "Type:";  col:=14 \row:=3 \ GOSUB 110 PRINT "Data"; col:=25 \row:=3 \ GOSUB 110 PRINT "Field"; col:=36 \row:=3 \ GOSUB 110 PRINT "PARAM";  col:=6 \row:=4 \ GOSUB 110 PRINT "Offset:";  col:=8 \row:=5 \ GOSUB 110 PRINT "Size:";  col:=14 \row:=7 \ GOSUB 110 PRINT "VDT";  col:=6 \row:=8 \ GOSUB 110 PRINT "Offset:"; col:=46 \row:=8 \ GOSUB 110 PRINT "Entry size:";  col:=7 \row:=9 \ GOSUB 110 PRINT "Token:"; col:=49 \row:=9 \ GOSUB 110 PRINT "Pointer:";  col:=14 \row:=11 \ GOSUB 110 PRINT "DSAT";  col:=8 \row:=12 \ GOSUB 110 PRINT "Type:"; col:=48 \row:=12 \ GOSUB 110 PRINT "Var Size:";  col:=6 \row:=13 \ GOSUB 110 PRINT "Offset:"; col:=22 \row:=13 \ GOSUB 110 PRINT "Pointer:"; col:=44 \row:=13 \ GOSUB 110 PRINT "Str/Rec Size:";  col:=4 \row:=14 \ GOSUB 110 PRINT "Element1:"; col:=21 \row:=14 \ GOSUB 110 PRINT "Element2:"; col:=48 \row:=14 \ GOSUB 110 PRINT "Element3:";  col:=2 \row:=15 \ GOSUB 110 PRINT "Entry size:"; col:=24 \row:=15 \ GOSUB 110 PRINT "Array:"; col:=50 \row:=15 \ GOSUB 110 PRINT "Length:";  col:=2 \row:=17 \ GOSUB 110 PRINT "FOR/NEXT or"; col:=17 \row:=17 \ GOSUB 110 PRINT "Variable Type"; col:=34 \row:=17 \ GOSUB 110 PRINT "Named Variable "; col:=52 \row:=17 \ GOSUB 110 PRINT "INTEGER or REAL";  col:=2 \row:=18 \ GOSUB 110 PRINT "Named Vars:";  col:=2 \row:=20 \ GOSUB 110 PRINT "Record#"; col:=12 \row:=20 \ GOSUB 110 PRINT "Total Refs"; col:=25 \row:=20 \ GOSUB 110 PRINT "Parent Rec"; col:=38 \row:=20 \ GOSUB 110 PRINT "Var Type"; col:=49 \row:=20 \ GOSUB 110 PRINT "ExtCmd"; col:=58 \row:=20 \ GOSUB 110 PRINT "Is Record"; col:=70 \row:=20 \ GOSUB 110 PRINT "Is Field"; RETURN  DATA $00,"",$23,"RUN",$24,"KILL",$29,"CREATE",$2A,"OPEN",$30,"CLOSE",$32,"DELETE",$33,"CHAIN",$34,"SHELL"