PROCEDURE setOpts(* Version 1.2.10 *)(* Colors *)TYPE COLR=white,blue,black,green,red,yellow,magenta,cyan,white2,blue2,black2,green2,red2,yellow2,magenta2,cyan2:BYTEDIM color:COLR(* Strings *)DIM dFile:STRING[29]; key,lastKey:STRING[1]; keys:STRING[17]; version,colorName:STRING[8](* Variables *)DIM dPath,regNum,curSet,col,row,tempRow,curRow,opts(26),defaults(26),defFcol,defBcol,packet(32),callCode:BYTEDIM er,er1:INTEGERDIM dOpen,endProgram,colorsTab,viewsTab,filesTab,menu,colorChange:BOOLEAN(* Registers *)TYPE REG=cc,a,b,dp:BYTE; x,y,u:INTEGERDIM regs:REG(* Instruction Statements *)ON ERROR GOTO 2BASE 0(* Get Pause and Page *)callCode:=$8D \(* Get Window Packet *)regs.a:=2regs.b:=$00regs.x:=ADDR(packet)RUN SysCall(callCode,regs)(* Initializations *)endProgram:=FALSE \colorsTab:=FALSE \viewsTab:=TRUE \filesTab:=FALSEcolorChange:=FALSEkeys:="CcDdEeFfSsVv"+CHR$(13)+CHR$(8)+CHR$(9)+CHR$(10)+CHR$(12)regNum:=0curSet:=0(* Colors *)color.white=0 \color.blue=1 \color.black=2 \color.green=3color.red=4 \color.yellow=5 \color.magenta=6 \color.cyan=7color.white2=8 \color.blue2=9 \color.black2=10 \color.green2=11color.red2=12 \color.yellow2=13 \color.magenta2=14 \color.cyan2=15(* Get User Options from initDB *)dFile:="/DD/DATA/initDB"dOpen:=FALSEOPEN #dPath,dFile:READdOpen:=TRUEGET #dPath,versionGET #dPath,optsGET #dPath,defFcolGET #dPath,defBcolCLOSE #dPathdOpen:=FALSE(* User and Default Options Packets *)GOSUB 410              \!create default settings(* Start of Program *)(* SHELL "TMode eko=0"packet(4):=0callCode:=$8E \(* Set Window Packet *)regs.a:=2regs.b:=$00regs.x:=ADDR(packet)RUN SysCall(callCode,regs)RUN GFX2("CUROFF")RUN GFX2("OWSET",1,18,2,44,20,opts(3),opts(4)) \!outer overlay!RUN GFX2("UNDLNON")PRINT " Options";!RUN GFX2("UNDLNOFF")RUN GFX2("CURXY",4,19)RUN GFX2("UNDLNON")PRINT "S";RUN GFX2("UNDLNOFF")PRINT "ave and Exit";RUN GFX2("CURXY",22,19)RUN GFX2("UNDLNON")PRINT "D";RUN GFX2("UNDLNOFF")PRINT "efaults";RUN GFX2("CURXY",36,19)RUN GFX2("UNDLNON")PRINT "E";RUN GFX2("UNDLNOFF")PRINT "xit";RUN GFX2("OWSET",1,18,3,44,2,opts(5),opts(6)) \!'tabs' overlayRUN GFX2("OWSET",1,18,4,44,17,opts(7),opts(8)) \!inner overlaykey:="V"  \ lastKey:="V"GOSUB 200   \!display Views Tab1 GOSUB 10  \!main program loop begins hereIF endProgram THEN(* I need to rethink this now. It served during development, but now needs to be more indepth. *)2 RUN GFX2("OWEND")  \!serves as error trap since the error won't be dealt with otherwise  RUN GFX2("OWEND")  RUN GFX2("OWEND")(*  SHELL "TMode eko=1"  packet(4):=1  callCode:=$8E \(* Set Window Packet *)  regs.a:=2  regs.b:=$00  regs.x:=ADDR(packet)  RUN SysCall(callCode,regs)  RUN GFX2("CURON")  RUN GFX2("DEFCOL")  er:=ERR  ON ERROR GOTO 3  IF er>0 THEN    SHELL "ex RunB ErrorCodes ("+STR$(er)+",1)"    (* Decide what to do *)    END  ENDIF3 er1:=ERR  IF er1=43 THEN    PRINT "Error: "; er    END  ENDIF  ENDELSE GOTO 1  \!establishes main program loopENDIF(* Input Loop *)10 key:=""REPEAT  RUN INKEY(key)UNTIL key<>""IF SUBSTR(key,keys)>0 THEN  IF SUBSTR(key,"CcVvFf")>0 THEN  \!only if a "tab" key was pressed    lastKey:=key    PRINT CHR$(12);  ENDIF  IF key=CHR$(8) THEN  \!Left Arrow    GOSUB 60  ELSE IF key=CHR$(9) THEN  \!Right Arrow    GOSUB 70  ELSE IF key=CHR$(10) THEN  \!Down Arrow    GOSUB 80  ELSE IF key=CHR$(12) THEN  \!Up Arrow    GOSUB 90  ELSE IF SUBSTR(key,"Cc")>0 THEN  \!Colors tab    colorsTab:=TRUE \viewsTab:=FALSE \filesTab:=FALSE    GOSUB 100  ELSE IF SUBSTR(key,"Dd")>0 THEN  \!set options to defaults    opts:=defaults    IF SUBSTR(lastKey,"Cc")>0 THEN      key:="C"      GOSUB 100    ELSE IF SUBSTR(lastKey,"Ff")>0 THEN      key:="F"      GOSUB 300    ELSE IF SUBSTR(lastKey,"Vv")>0 THEN      key:="V"      GOSUB 200    ENDIF  \ ENDIF  \ ENDIF  ELSE IF SUBSTR(key,"Ff")>0 THEN  \!Files tab    colorsTab:=FALSE \viewsTab:=FALSE \filesTab:=TRUE    GOSUB 300  ELSE IF SUBSTR(key,"Ee")>0 THEN  \!Exit without saving changes    endProgram:=TRUE  ELSE IF SUBSTR(key,"Ss")>0 THEN  \!Save changes and exit    endProgram:=TRUE    (* Save User Options to initDB *)    OPEN #dPath,dFile:WRITE    dOpen:=TRUE    SEEK #dPath,SIZE(version)    PUT #dPath,opts    CLOSE #dPath    dOpen:=FALSE  ELSE IF SUBSTR(key,"Vv")>0 THEN  \!Views tab    colorsTab:=FALSE \viewsTab:=TRUE \filesTab:=FALSE    GOSUB 200  ENDIF  \ ENDIF  \ ENDIF  \ ENDIF  \ ENDIF  ENDIF  \ ENDIF  \ ENDIF  \ ENDIF  \ ENDIFELSE GOTO 10  \!trap unexpected input charactersENDIFRETURN(* Prints current setting for each option *)20 RUN GFX2("CURXY",col,row)RUN GFX2("REVON")IF SUBSTR(key,"VvFf")>0 THEN  GOSUB 340  \!print ON/OFFELSE  GOSUB 350  \!print color nameENDIFRUN GFX2("REVOFF")RETURN(* Determine row to print option setting on *)(* Colors Tab *)30 IF curSet=1 THEN  row:=2ELSE IF curSet=2 THEN  row:=3ELSE IF curSet=3 THEN  row:=6ELSE IF curSet=4 THEN  row:=7ELSE IF curSet=5 THEN  row:=10ELSE IF curSet=6 THEN  row:=11ELSE IF curSet=7 THEN  row:=14ELSE IF curSet=8 THEN  row:=15ENDIF  \ ENDIF  \ ENDIF  \ ENDIFENDIF  \ ENDIF  \ ENDIF  \ ENDIFRUN GFX2("REVON")RUN GFX2("CURXY",col,row)GOSUB 350RUN GFX2("REVOFF")RETURN(* Views Tab *)40 IF regNum=0 THEN  row:=1ELSE IF regNum=9 THEN  row:=4ELSE IF regNum=10 THEN  row:=5ELSE IF regNum=11 THEN  row:=6ELSE IF regNum=12 THEN  row:=7ELSE IF regNum=13 THEN  row:=8ELSE IF regNum=14 THEN  row:=9ELSE IF regNum=15 THEN  row:=10ELSE IF regNum=16 THEN  row:=11ELSE IF regNum=17 THEN  row:=12ELSE IF regNum=18 THEN  row:=13ELSE IF regNum=19 THEN  row:=14ELSE IF regNum=20 THEN  row:=16ENDIF  \ ENDIF  \ ENDIF  \ ENDIFENDIF  \ ENDIF  \ ENDIFENDIF  \ ENDIF  \ ENDIFENDIF  \ ENDIF  \ ENDIFRUN GFX2("REVON")RUN GFX2("CURXY",col,row)GOSUB 340RUN GFX2("REVOFF")RETURN(* Files Tab *)50 IF regNum=21 THEN  row:=6ELSE IF regNum=22 THEN  row:=7ELSE IF regNum=23 THEN  row:=8ELSE IF regNum=24 THEN  row:=9ELSE IF regNum=25 THEN  row:=10ENDIF  \ ENDIF  \ ENDIFENDIF  \ ENDIFRUN GFX2("REVON")RUN GFX2("CURXY",col,row)GOSUB 340RUN GFX2("REVOFF")RETURN(* Toggle ON/OFF or display Background color picker *)(* Left Arrow *)60 IF colorsTab THEN  GOSUB 420  RUN GFX2("REVON")  RUN GFX2("CURXY",col,row)  GOSUB 350  RUN GFX2("REVOFF")ELSE  IF opts(regNum)=1 THEN    opts(regNum):=0  ELSE    opts(regNum):=1  ENDIF  RUN GFX2("REVON")  RUN GFX2("CURXY",col,row)  GOSUB 340  RUN GFX2("REVOFF")ENDIFRETURN(* Toggle ON/OFF or display Foreground color picker *)(* Right Arrow *)70 IF colorsTab THEN  GOSUB 420  RUN GFX2("REVON")  RUN GFX2("CURXY",col,row)  GOSUB 350  RUN GFX2("REVOFF")ELSE  IF opts(regNum)=1 THEN    opts(regNum):=0  ELSE    opts(regNum):=1  ENDIF  RUN GFX2("REVON")  RUN GFX2("CURXY",col,row)  GOSUB 340  RUN GFX2("REVOFF")ENDIFRETURN(* Select option from list *)(* Down Arrow *)80 RUN GFX2("CURXY",col,row) \!turn off reverse video at current positionIF colorsTab THEN  GOSUB 350 \!print color nameELSE  GOSUB 340 \!print ON/OFFENDIFIF colorsTab THEN  curSet:=curSet+1 \!curSet is the opts(element) number: 1-8ELSE  regNum:=regNum+1ENDIFIF colorsTab THEN  col:=34  IF curSet>8 THEN    curSet:=1  ENDIF  GOSUB 30ELSE IF viewsTab THEN  IF regNum=1 THEN    regNum:=9 \!regNum is the opts(element) number: 0 and 9-20  ELSE IF regNum=21 THEN    regNum:=0  ENDIF  \ ENDIF  GOSUB 40ELSE IF filesTab THEN  col:=40  IF regNum>25 THEN    regNum:=21 \!regNum is the opts(element) number: 21-25  ENDIF  GOSUB 50ENDIF  \ ENDIF  \ ENDIFRETURN(* Select option from list *)(* Up Arrow *)90 RUN GFX2("CURXY",col,row)IF colorsTab THEN  GOSUB 350 \!print color nameELSE  GOSUB 340 \!print ON/OFFENDIFIF colorsTab THEN  curSet:=curSet-1ELSE  regNum:=regNum-1ENDIFIF colorsTab THEN  col:=34  IF curSet<1 THEN    curSet:=8  ENDIF  GOSUB 30ELSE IF viewsTab THEN  col:=40  IF regNum=8 THEN    regNum:=0  ELSE IF regNum=255 THEN    regNum:=20  ENDIF  \ ENDIF  GOSUB 40ELSE IF filesTab THEN  col:=40  IF regNum<21 THEN    regNum:=25  ENDIF  GOSUB 50ENDIF  \ ENDIF  \ ENDIFRETURN(* Colors Dialog *)100 RUN GFX2("OWEND")  \!close outer overlayPRINT CHR$(12);RUN GFX2("COLOR",color.blue,color.white)PRINT "    ";RUN GFX2("UNDLNON")PRINT "C";RUN GFX2("UNDLNOFF")PRINT "OLORS    ";RUN GFX2("COLOR",color.red,color.yellow)PRINT "|     ";RUN GFX2("UNDLNON")PRINT "V";RUN GFX2("UNDLNOFF")PRINT "IEWS    |     ";RUN GFX2("UNDLNON")PRINT "F";RUN GFX2("UNDLNOFF")PRINT "ILES    ";!PRINT "               \----------------------------";RUN GFX2("OWSET",1,18,4,44,17,opts(7),opts(8))  \!reopen outer overlayPRINT ""PRINT " Window"PRINT "  ForeGround"PRINT "  BackGround"PRINT ""PRINT " BackGround Overlay"PRINT "  ForeGround"PRINT "  BackGround"PRINT ""PRINT " Middle Overlay"PRINT "  ForeGround"PRINT "  BackGround"PRINT ""PRINT " ForeGround Overlay"PRINT "  ForeGround"PRINT "  BackGround"PRINT "";!opts(1):=color.black  \!main screen foreground colorcurSet:=1RUN GFX2("CURXY",34,2)GOSUB 350!opts(2):=color.green  \!main screen background colorcurSet:=2RUN GFX2("CURXY",34,3)GOSUB 350!opts(3):=color.yellow \!background overlay foreground colorcurSet:=3RUN GFX2("CURXY",34,6)GOSUB 350!opts(4):=color.blue   \!background overlay background colorcurSet:=4RUN GFX2("CURXY",34,7)GOSUB 350!opts(5):=color.blue   \!middle overlay foreground colorcurSet:=5RUN GFX2("CURXY",34,10)GOSUB 350!opts(6):=color.white  \!middle overlay background colorcurSet:=6RUN GFX2("CURXY",34,11)GOSUB 350!opts(7):=color.black  \!foreground overlay foreground colorcurSet:=7RUN GFX2("CURXY",34,14)GOSUB 350!opts(8):=color.white  \!foreground overlay background colorcurSet:=8RUN GFX2("CURXY",34,15)GOSUB 350col:=34 \row:=2curSet:=1GOSUB 20RETURN(* Views Dialog *)200 RUN GFX2("OWEND")  \!close outer overlayPRINT CHR$(12);RUN GFX2("COLOR",color.red,color.yellow)PRINT "    ";RUN GFX2("UNDLNON")PRINT "C";RUN GFX2("UNDLNOFF")PRINT "OLORS    |";RUN GFX2("COLOR",color.blue,color.white)PRINT "     ";RUN GFX2("UNDLNON")PRINT "V";RUN GFX2("UNDLNOFF")PRINT "IEWS    ";RUN GFX2("COLOR",color.red,color.yellow)PRINT "|     ";RUN GFX2("UNDLNON")PRINT "F";RUN GFX2("UNDLNOFF")PRINT "ILES    ";!PRINT "-------------/                \-------------";RUN GFX2("OWSET",1,18,4,44,17,opts(7),opts(8))  \!reopen outer overlay!RUN GFX2("COLOR",color.black,color.white)PRINT ""PRINT " Display Options at Startup"PRINT ""PRINT " View"PRINT "  Processes"PRINT "   Instruction Decode"PRINT "   Token Counts"PRINT "   Line Reference List (unnumbered)"PRINT "   Line Reference List (numbered)"PRINT "   Variable Reference List (unsorted)"PRINT "   Variable Reference List (naming)"PRINT "   Variable Reference List (sorted)"PRINT "   VDT Validation"PRINT "   DSAT Count"PRINT "   DSAT Validation"PRINT ""PRINT "  Source Output";!opts(0):=1            \!display opts dialog at startupregNum:=0RUN GFX2("CURXY",40,1)GOSUB 340!opts(9):=1            \!View ProcessesregNum:=9RUN GFX2("CURXY",40,4)GOSUB 340!opts(10):=1           \!view Instruction DecoderegNum:=10RUN GFX2("CURXY",40,5)GOSUB 340!opts(11):=1           \!view Token CountsregNum:=11RUN GFX2("CURXY",40,6)GOSUB 340!opts(12):=0           \!view Line Reference List (unnumbered)regNum:=12RUN GFX2("CURXY",40,7)GOSUB 340!opts(13):=0           \!view Line Reference List (numbered)regNum:=13RUN GFX2("CURXY",40,8)GOSUB 340!opts(14):=0           \!view Variable Reference List (unsorted)regNum:=14RUN GFX2("CURXY",40,9)GOSUB 340!opts(15):=0           \!view Variable Reference List (naming)regNum:=15RUN GFX2("CURXY",40,10)GOSUB 340!opts(16):=0           \!view Variable Reference List (sorted)regNum:=16RUN GFX2("CURXY",40,11)GOSUB 340!opts(17):=0           \!view VDT ValidationregNum:=17RUN GFX2("CURXY",40,12)GOSUB 340!opts(18):=0           \!view DSAT CountregNum:=18RUN GFX2("CURXY",40,13)GOSUB 340!opts(19):=0           \!view DSAT ValidationregNum:=19RUN GFX2("CURXY",40,14)GOSUB 340!opts(20):=1           \!view Source OutputregNum:=20RUN GFX2("CURXY",40,16)GOSUB 340col:=40 \row:=1regNum:=0GOSUB 20RETURN(* Files Dialog *)300 RUN GFX2("OWEND")  \!close outer overlayPRINT CHR$(12);RUN GFX2("COLOR",color.red,color.yellow)PRINT "    ";RUN GFX2("UNDLNON")PRINT "C";RUN GFX2("UNDLNOFF")PRINT "OLORS    |     ";RUN GFX2("UNDLNON")PRINT "V";RUN GFX2("UNDLNOFF")PRINT "IEWS    |";RUN GFX2("COLOR",color.blue,color.white)PRINT "     ";RUN GFX2("UNDLNON")PRINT "F";RUN GFX2("UNDLNOFF")PRINT "ILES    ";RUN GFX2("COLOR",color.red,color.yellow)!PRINT "----------------------------/               ";RUN GFX2("OWSET",1,18,4,44,17,opts(7),opts(8))  \!reopen outer overlay!RUN GFX2("COLOR",color.black,color.white)PRINT ""PRINT ""PRINT ""PRINT ""PRINT " Create"PRINT ""PRINT "  <modulename>Raw.txt"PRINT "  <modulename>Lines.txt"PRINT "  <modulename>Vars.txt"PRINT "  <modulename>VDT.txt"PRINT "  <modulename>DSAT.txt"PRINT "";!opts(21):=1           \!create <modulename>Raw.txt fileregNum:=21RUN GFX2("CURXY",40,6)GOSUB 340!opts(22):=1           \!create <modulename>Lines.txt fileregNum:=22RUN GFX2("CURXY",40,7)GOSUB 340!opts(23):=1           \!create <modulename>Vars.txt fileregNum:=23RUN GFX2("CURXY",40,8)GOSUB 340!opts(24):=1           \!create <modulename>VDT.txt fileregNum:=24RUN GFX2("CURXY",40,9)GOSUB 340!opts(25):=1           \!create <modulename>DSAT.txt fileregNum:=25RUN GFX2("CURXY",40,10)GOSUB 340col:=40 \row:=6regNum:=21GOSUB 20RETURN(* Print ON/OFF *)340 IF opts(regNum)=1 THEN  PRINT "ON ";ELSE  PRINT "OFF";ENDIFRETURN(* Print Color Name *)350 RESTORE 400REPEAT  READ regNum,colorNameUNTIL regNum=opts(curSet)PRINT colorName;IF colorChange AND (curSet=7 OR curSet=8) THEN colorChange:=FALSEGOSUB 100ENDIF RETURN400 DATA 0,"White    ",1,"Blue     ",2,"Black    ",3,"Green    ",4,"Red      ",5,"Yellow   ",6,"Magenta  ",7,"Cyan     "DATA 8,"White    ",9,"Blue     ",10,"Black    ",11,"Green    ",12,"Red      ",13,"Yellow   ",14,"Magenta  ",15,"Cyan     "410 (* Default Settings *)(* Program Options *)defaults(0):=1            \!display options dialog at startupdefaults(1):=defFcol      \!main screen foreground colordefaults(2):=defBcol      \!main screen background colordefaults(3):=color.yellow \!background overlay foreground colordefaults(4):=color.blue   \!background overlay background colordefaults(5):=color.blue   \!foreground overlay foreground colordefaults(6):=color.white  \!foreground overlay background colordefaults(7):=color.black  \!foreground overlay foreground colordefaults(8):=color.white  \!foreground overlay background color(* Window Views *)defaults(9):=1            \!view processes(* decode windows *)defaults(10):=1           \!view Instruction Decodedefaults(11):=1           \!view Token Countsdefaults(12):=0           \!view Line Reference List (unnumbered)defaults(13):=0           \!view Line Reference List (numbered)(* defVars windows *)defaults(14):=0           \!view Variable Reference List (unsorted)defaults(15):=0           \!view Variable Reference List (naming)defaults(16):=0           \!view Variable Reference List (sorted)defaults(17):=0           \!view VDT Validation(* buileSrc windows *)defaults(18):=0           \!view DSAT Countdefaults(19):=0           \!view DSAT Validationdefaults(20):=1           \!view Source Output(* File  options*)defaults(21):=1           \!create <modulename>Raw.txt filedefaults(22):=1           \!create <modulename>Lines.txt filedefaults(23):=1           \!create <modulename>Vars.txt filedefaults(24):=1           \!create <modulename>VDT.txt filedefaults(25):=1           \!create <modulename>DSAT.txt fileRETURN(* Color Picker Menu *)420 RUN GFX2("OWSET",1,42,9,10,8,opts(3),opts(4))  \!open color picker overlayIF key=CHR$(8) THEN  \!left (background) menu  menu:=TRUE  \!tells the difference between left (background) menu and right (foreground) menu  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT " ";  RUN GFX2("COLOR",color.white,color.white)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.blue,color.blue)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.black,color.black)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.green,color.green)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.red,color.red)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.yellow,color.yellow)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.magenta,color.magenta)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.cyan,color.cyan)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)ELSE  \!right (foreground) menu  menu:=FALSE  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT " ";  RUN GFX2("COLOR",color.white2,color.white2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.blue2,color.blue2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.black2,color.black2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.green2,color.green2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.red2,color.red2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.yellow2,color.yellow2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.magenta2,color.magenta2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)  PRINT  PRINT " ";  RUN GFX2("COLOR",color.cyan2,color.cyan2)  PRINT "        ";  RUN GFX2("COLOR",color.yellow,color.blue)ENDIF(* Set Current Selection Pointer *)RUN GFX2("COLOR",color.yellow,color.blue)RUN GFX2("CURXY",0,0)curRow:=opts(curSet)tempRow:=curRowIF curRow>7 AND curRow<16 THENcurRow:=curRow-8ENDIFRUN GFX2("CURXY",0,curRow)PRINT ">";(* Input For Color Selector *)430 key:=""REPEATRUN INKEY(key)UNTIL SUBSTR(key,RIGHT$(keys,5))>0IF key=CHR$(10) THEN  \!Down ArrowRUN GFX2("CURXY",0,curRow)PRINT " ";curRow:=curRow+1IF curRow=8 THENcurRow:=0ENDIFRUN GFX2("CURXY",0,curRow)PRINT ">";ELSE IF key=CHR$(12) THEN  \!Up ArrowRUN GFX2("CURXY",0,curRow)PRINT " ";curRow:=curRow-1IF curRow=255 THENcurRow:=7ENDIFRUN GFX2("CURXY",0,curRow)PRINT ">";ENDIF  \ ENDIFIF key<>CHR$(13) THEN 430 \!Go back to selection loopIF menu THENopts(curSet):=curRowELSEopts(curSet):=curRow+8ENDIFIF tempRow<>curRow THEN colorChange:=TRUEENDIF RUN GFX2("OWEND")  \!close color pickerRETURN