PROCEDURE usymTabVal (* Variable File Record *) TYPE VFP1=vdTkn:BYTE; vdPtr,vdSiz,dsPtr,dsvSiz,dsSiz,dmSiz,fSiz,pSiz,elem1,elem2,elem3,vSRLen:INTEGER TYPE VFP2=vArray:STRING[19]; vName:STRING[29]; vStrLen:STRING[7]; vRecNum,vRefCnt,intReal,pVar:INTEGER TYPE VFP3=mTyp,vLnk,fNum:BYTE; pRec,pFld:BOOLEAN TYPE VFRC=vp1:VFP1; vp2:VFP2; vp3:VFP3 DIM varFRec:VFRC (* ==================== *) DIM byteVal,vPath,vToken:BYTE DIM mCount,VDCount,VDCnt,vdtCnt,vPointer,varCount:INTEGER DIM found,validated,vOpen:BOOLEAN DIM mSize:REAL DIM vFile,subName:STRING[29] (* ==================== *) (* Parameters *) PARAM filePath:BYTE; er:INTEGER; verbose:BOOLEAN; modSize,symTabOff:REAL; dataDir:STRING[16]  BASE 0 ON ERROR GOTO 100 subName:="" vPointer:=0 vOpen:=FALSE vFile:=dataDir+"varDefs" OPEN #vPath,vFile:UPDATE vOpen:=TRUE GET #vPath,varCount (* Validate VDT *) mSize:=modSize-3-symTabOff IF mSize>0 THEN    PRINT #2,"Validating Symbol Table ";   IF verbose THEN     PRINT #2     PRINT #2,"  VDT   Variable Name/"     PRINT #2,"Tk Ptr  Subroutine"   ENDIF   VDCount:=0 \vdtCnt:=0 \VDCnt:=0 \mCount:=0 \validated:=TRUE   SEEK #filePath,symTabOff   REPEAT      GET #filePath,vToken     GET #filePath,vPointer     mCount:=mCount+3     IF verbose THEN       PRINT #2 USING "h2,x1,h4",vToken,vPointer;      ELSE       PRINT #2, ".";     ENDIF     IF vToken=$A0 THEN        subName:=""       REPEAT          GET #filePath,byteVal         subName:=subName+CHR$(LAND(byteVal,$7F))         mCount:=mCount+1       UNTIL byteVal>127       IF verbose THEN         PRINT #2," "; subName;        ENDIF      ENDIF      found:=FALSE 10  SEEK #vPath,VDCount*SIZE(varFRec)+2     REPEAT        GET #vPath,varFRec       IF varFRec.vp1.vdTkn=vToken AND varFRec.vp1.vdPtr=vPointer THEN          found:=TRUE       ENDIF        VDCount:=VDCount+1     UNTIL found OR VDCount=varCount     IF NOT(found) THEN        IF VDCnt=0 THEN          VDCnt:=1 \VDCount:=0         GOTO 10       ENDIF      ENDIF      VDCount:=VDCount-1     IF found THEN        IF verbose THEN           PRINT #2," "; varFRec.vp2.vName; " Validated";        ENDIF     ELSE        IF verbose THEN         PRINT #2," Unidentified";        ENDIF       validated:=FALSE     ENDIF      vdtCnt:=vdtCnt+1     GOSUB 50 \REM display counts     VDCnt:=0   UNTIL mCount=mSize   IF NOT(verbose) THEN     PRINT #2, " ";   ENDIF   PRINT #2,"Done" ELSE    PRINT #2,"No VDT Entries" ENDIF  IF NOT(validated) THEN    PRINT #2,"Symbol Table Not Validated" ELSE    PRINT #2,"Symbol Table Validated" ENDIF  CLOSE #vPath vOpen:=FALSE END  (* Display Counts *) 50 IF verbose THEN   PRINT  " "; vdtCnt ENDIF RETURN   100 er:=ERR IF vOpen THEN CLOSE #vPath vOpen:=FALSE ENDIF END